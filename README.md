# RPAmaker

軽量なテキストベースRPAランタイム。テキストで記述したコマンドを読み込み、モジュール単位で実装されたアクションを順に実行します。

## 概要
- コマンドファイル（テキスト）でワークフローを定義し、`module/` 内のアクションで実行します。
- 設定は YAML で管理し、ログ出力やデコレータで実行制御（リトライ・計測等）を行います。

## 特長
- モジュール化されたアクション群（UI、Playwright、Keyboard、Sound など）
- YAML ベースのパラメータ管理（`param/`）
- 実行ログ・リトライ・計測を行うデコレータを備える

## 必要条件
- Python 3.8 以上（プロジェクトで使用している環境に合わせてください）
- 必要な追加パッケージは各モジュールに依存します（例: Playwright を使う場合は `playwright` が必要）

## クイックスタート
1. リポジトリをクローンまたは取得
2. 仮想環境を作成して依存をインストール（モジュールに応じて）

```powershell
python -m venv .venv
.\.venv\Scripts\Activate.ps1
pip install -r requirements.txt   # 必要なら作成してください
```

3. `param/` と `init.yaml` を確認して実行環境を整える
4. コマンドファイルを用意して実行

```powershell
python CommandRPA.py path\to\commands.txt
```

## 主要ファイル
- `CommandRPA.py` — エントリポイント、初期化と実行管理
- `readLines.py` — コマンドファイルの読み取りと行実行
- `moduleList.py` — 利用可能モジュールの管理
- `module/` — 各種アクション実装（`playwrightActions.py`, `uiActions.py`, `keyboardActions.py` など）
- `param/` — パラメータ定義（`mod/`、`sys/` 等のサブフォルダあり）
- `lib/` — ロガー、デコレータ、シャットダウン処理などの共通機能

## 設定（ポイント）
- 初期設定は `init.yaml`。
- モジュール別設定は `param/mod/*.yaml` に配置。
- 機密情報は YAML に直接書かず環境変数やシークレットストアを利用してください。

## 開発・拡張方法
- 新しいアクションを追加するには `module/` にファイルを作成し、`moduleList.py` に登録してください。
- ログや実行計測は `lib/decoratorSetting.py` のデコレータを利用してください。

## 注意事項
- コマンド実行中に外部コマンドや `eval` を用いる場合はセキュリティに注意してください。
- 自動操作を行うため環境ごとの差異（画面サイズ、フォーカス等）に注意して設定してください。

## 貢献
- Issue や Pull Request を歓迎します。コーディング規約やテストを整えてから送ってください。

## ライセンス
- このリポジトリに明示的なライセンスがない場合は、利用前に作成者に確認してください。
